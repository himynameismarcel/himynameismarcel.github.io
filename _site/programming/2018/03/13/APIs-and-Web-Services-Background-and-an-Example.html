<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>APIs and Web Services: Background and an Example</title>
  <meta name="description" content="About a year ago I familiarized myself with web-services and APIs (Application Program(ming) Interface) more generally to get a better understanding of the t...">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/programming/2018/03/13/APIs-and-Web-Services-Background-and-an-Example.html">
  <link rel="alternate" type="application/rss+xml" title="himynameismarcel" href="/feed.xml">

  <link rel=”stylesheet” href=””>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/config/TeX-MML-AM_CHTML.js"></script>

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">himynameismarcel</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">APIs and Web Services: Background and an Example</h1>
    <p class="post-meta">
      <time datetime="2018-03-13T13:37:05+01:00" itemprop="datePublished">
        
        Mar 13, 2018
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>About a year ago I familiarized myself with <strong>web-services</strong> and <strong>APIs</strong> (<em>Application Program(ming) Interface</em>) more generally to get a better understanding of the technological background. My conclusion back then was that the terms are used in various contexts and depending on the exact context, everyone seemed to have a vague idea about what they actually mean and stand for.</p>

<h3 id="a-first-explainer-getting-some-intuition">A First Explainer: Getting Some Intuition</h3>
<p>In an introductory class about web development from <a href="https://www.linkedin.com/in/coltsteele/">Colt Steele</a> which I had attended last year, he introduces APIs at some point in the course right after having moved from front-end technologies to back-end web development as follows: <em>API’s are interfaces for code/computers to talk to one another.</em></p>

<p>He goes on to clarify that the term ‘API’ is actually a <em>‘broader term that refers to any type of code/interface that is made for other code to be used with/to communicated with’</em>. Referring to the corresponding <a href="https://en.wikipedia.org/wiki/Application_programming_interface">Wikipedia article</a>, the definition of an API undermines the very broad/vague definition that Colt used to introduce APIs by stating that <em>‘[a]n application programming interface (API) is a set of routines, protocols, and tools for building software and applications.’</em> Hence, the term API comprises anything ranging from libraries, packages, modules to databases, web-APIs, etc.<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup><br /></p>

<h4 id="commonly-referred-to-as-apis-today-web-apis">Commonly referred to as APIs today: web APIs</h4>
<p>But what people nowadays typically mean they refer to APIs are <strong>web (application) APIs</strong>, which are, strictly speaking, only a subset of the much broader definition of APIs from above. It is only that web APIs have become so prevalent and common, that when people refer to an API they usually actually are referring to a <strong>web API</strong>, meaning any sort of generic interface to an application via the web.</p>

<p>Today a classical example where web APIs are exploited extensively are all kinds of travel search engines like Trivago, Expedia, Checkfelix, etc., that aggregate information from a number of other services via the corresponding web APIs and thereby make the respective data of the services whose web APIs they are consuming available on their platforms for customers to e.g., compare prices.</p>

<p>The above example already makes clear, that the way that applications get data from web APIs or access its interface is through the internet (or more precisely, via <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a>, the ‘Hypertext Transfer Protocol’ which is <em>the</em> foundation of data communication for the modern world wide web and functions as a request-response protocol in the client-server computing model).</p>

<p>Today almost all major (internet)-giants like <a href="https://www.programmableweb.com/api/twitter">Twitter</a>, <a href="https://www.programmableweb.com/api/facebook">Facebook</a>, <a href="https://console.developers.google.com/apis/dashboard">Google</a> (in their developers section; their most popular/interesting API being their Maps API), <a href="https://www.programmableweb.com/search/ebay">eBay</a>, <a href="https://www.programmableweb.com/search/yahoo">Yahoo</a>, <a href="https://www.programmableweb.com/category/all/apis?keyword=amazon">Amazon</a>, etc. actively maintain dozens of various web-APIs that are all designed for specific purposes and audiences and have become part of these companies’ standard product range/deliverables.</p>

<h4 id="two-examples-reddits-api-and-yahoo-weather">Two Examples: Reddit’s API and Yahoo Weather</h4>
<p>As an example and to distinguish a web API from a <em>normal</em> human-readable website, Colt refers to <a href="https://www.reddit.com/r/aww">reddit.com/r/aww</a> which represents a subreddit for cute photos in a human-readable format (which our browser appropriately renders for us to have a look at). In other words, the underlying data (of content in the route ‘/r/aww’) is embedded in HTML-structure of the page which we get back rendered when making an HTTP request to <a href="https://www.reddit.com/r/aww">reddit.com/r/aww</a>. But there is also the corresponding web API-version for <em>code</em> to interact with of exactly this ‘aww’ subreddit available under <a href="https://www.reddit.com/r/aww.json">reddit.com/r/aww.json</a> that strips away all the extra-clutter that comes along with the data (HTML, etc.).<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup> The base-bone data in <a href="https://en.wikipedia.org/wiki/JSON">JSON</a> (Javascript Object Notation) format is easier for computers/code/applications to handle as compared to the human-readable version from before. Together with another very popular output-format called <a href="https://en.wikipedia.org/wiki/XML">XML</a> (eXtensible Markup Language), ‘JSON’ are the standard output-formats of HTTP requests to web APIs (so web APIs respond with data directly).</p>

<p>Another simple example is the <a href="https://developer.yahoo.com/weather/">Yahoo Weather API</a> which allows to easily toggle between JSON and XML - responses and, e.g., refers you to the following end-point (URL) for a request for the sunset time in Hawaii in JSON - format (as an arbitrary example): <a href="https://query.yahooapis.com/v1/public/yql?q=select%20astronomy.sunset%20from%20weather.forecast%20where%20woeid%20in%20(select%20woeid%20from%20geo.places(1)%20where%20text%3D%22maui%2C%20hi%22)&amp;format=json&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys">Endpoint Sunset time Hawaii</a>. The data that should be displayed in JSON-format is the following:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="nl">query</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nx">created</span><span class="p">:</span> <span class="s2">"2018-03-23T21:26:22Z"</span><span class="p">,</span>
    <span class="nx">lang</span><span class="p">:</span> <span class="s2">"de-DE"</span><span class="p">,</span>
    <span class="nx">results</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">channel</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">astronomy</span><span class="p">:</span> <span class="p">{</span>
          <span class="nl">sunset</span><span class="p">:</span> <span class="s2">"6:37 pm"</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The corresponding output in XML-format would look as follows:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;query</span> <span class="na">xmlns:yahoo=</span><span class="s">"http://www.yahooapis.com/v1/base.rng"</span> <span class="na">yahoo:count=</span><span class="s">"1"</span> <span class="na">yahoo:created=</span><span class="s">"2018-03-23T21:28:07Z"</span> <span class="na">yahoo:lang=</span><span class="s">"de-DE"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;results&gt;</span>
    <span class="nt">&lt;channel&gt;</span>
      <span class="nt">&lt;yweather:astronomy</span> <span class="na">xmlns:yweather=</span><span class="s">"http://xml.weather.yahoo.com/ns/rss/1.0"</span> <span class="na">sunset=</span><span class="s">"6:37 pm"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/channel&gt;</span>
  <span class="nt">&lt;/results&gt;</span>
<span class="nt">&lt;/query&gt;</span>
<span class="c">&lt;!--  total: 18  --&gt;</span></code></pre></figure>

<h4 id="advantage-of-json-and-xml---formats">Advantage of JSON and XML - formats</h4>
<p>What makes the ‘raw’ data format returned from web APIs so attractive is that the response can, e.g., seamlessly be integrated into your own application/program. In such a scenario the HTTP-request to a certain endpoint of a web-API would therefore not be made via a browser but e.g., from within a program’s code (using certain packages that support HTTP-requests like <em>urllib</em> or <em>httplib</em> in Python, <em>httr</em> in R or <em>request</em> in NodeJS). Beyond that, there is also the possibility to fire HTTP-requests via the command-line using a tool called <code class="highlighter-rouge">curl</code> which ships with Macs by default but has to be installed on Windows machines. The bottom line is: browsers are not the only tools that can be used to make HTTP-requests to certain URLs (end-points).<sup id="fnref:3"><a href="#fn:3" class="footnote">3</a></sup></p>

<h4 id="web-api-vs-regular-websites">Web API vs. ‘regular websites’</h4>
<p>After all of the above, we could be confused and think that <em>regular</em> websites and web APIs are two completely different technologies <em>or</em> we could concentrate on the similarities (i.e., the fact that they use the same HTTP protocol to fetch for data) and think that they are actually practically the same. Truth is, the difference between the two is actually negligible. What makes APIs stand out are the already discussed format they send data back (JSON or XML instead of HTML) and an accompanied syntax (usually explained in a dedicated documentation) that has to be used in order to retrieve/locate certain end-points according to one’s own needs.</p>

<h4 id="useful-websites">Useful Websites</h4>
<p>As an interesting (not so say funny) application of such web APIs, in his web-development class Colt mentions <a href="https://ifttt.com/recipes">ifttt.com/recipes</a> which is a service that enables you to make apps and devices to work together by exploiting the connection/concatenation of web APIs (that are supported on this platform).</p>

<p>Further, a great place that collects a comprehensive list of available web APIs (i.e., kind of like an API directory) is  <a href="https://programmableweb.com">programmableweb.com</a>.</p>

<h3 id="a-second-explainer">A Second Explainer</h3>
<p>In his book <a href="http://shop.oreilly.com/product/0636920034391.do"><em>Web Scraping with Python (2015)</em></a><sup id="fnref:4"><a href="#fn:4" class="footnote">4</a></sup> which I recently read through some of the chapters, Ryan Mitchell introduces generic APIs as <em>‘[…] convenient interfaces between multiple disparate applications […]’</em> and that <em>‘[…] APIs are designed to serve as a lingua franca between different pieces of software that need to share information with each other’ (p. 49)</em>. Without going into much detail about <em>what</em> exactly is meant with this definition for a layman, <em>web (application) APIs</em> are introduced as what has been commonly understood in recent times when people refer to ‘APIs’ (exactly like we discussed in our first explainer above).</p>

<p>Mitchell goes on and lists a few simple <em>ground rules</em> that are common to almost all web APIs:</p>
<ul>
  <li><strong>Methods:</strong>
Information is requested via HTTP - requests whereby the four most commonly used ‘verbs’ are <code class="highlighter-rouge">GET, POST, PUT, DELETE</code>.</li>
  <li><strong>Authentication:</strong>
While there are many free API services, there are also many proprietary APIs that require some type of authentication before they can be used (e.g., Twitter).</li>
  <li><strong>Responses:</strong>
The most common types of response formatting are XML and JSON whereby in recent years JSON has become more and more popular. This can generally be attributed to (1) JSON files being generally smaller than their corresponding XML - counterparts and (2) that many backend frameworks used in web development nowadays use Javascript which natively integrates better with JSON - data.</li>
</ul>

<p>Two must-reads that Mitchell refers to to get a more or less complete overview of both the theory and practice of modern APIs are <a href="http://shop.oreilly.com/product/0636920028468.do"><em>RESTful Web APIs (2013)</em></a> by Richardson, Ruby and Amundsen as well as as video series on <a href="http://shop.oreilly.com/product/110000125.do"><em>Designing APIs for the Web</em></a> by Amundsen.</p>

<h3 id="a-third-explainer-and-building-your-own-web-api">A Third Explainer and Building Your Own Web-API</h3>
<p>My third encounter with APIs was in Miguel Grinberg’s book <a href="http://shop.oreilly.com/product/0636920031116.do"><em>Flask Web Development</em></a> where he introduces APIs by mentioning that in recent years <em>‘there has been a trend in web applications to move more and more of the business logic to the client side, producing an architecturak styke that is known as Rich Internet Applications (RIA). In RIAs, the server’s main (and sometimes only) function is to provide client application with data retrieval and storage services.’ (p. 175)</em> It is exactly in this setting that the server’s purposes reduces to becoming a <em>web service</em> or <em>Application Programming Interface (API)</em><sup id="fnref:5"><a href="#fn:5" class="footnote">5</a></sup>.
That is, Grinberg uses the terms <em>(web) APIs</em> and <em>web service</em> interchangeably.</p>

<p>Mentioning the RPC (Remote Procedure Call) and SOAP (Simplified Object Access Protocols) that were the popular choices by which RIAs would communicate with a web service in the past years, Grinberg’s focus then shifts fully on the more recently emerged REST (Representational State Transfer) architecture for web services by exploiting and being built on the most powerful distributed computing system that we all know: the World Wide Web.</p>

<p>Referring to <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">Roy Fielding’s dissertation</a> which introduces the REST architecture for web services, Grinberg lists the six defining characteristics that make a web service RESTful:</p>
<ul>
  <li><em>Client-Server</em>: There must be a clear separation between the client and the server.</li>
  <li><em>Stateless</em>: A client request must contain all the information that is necessary to carry out the request. The server must not store any state about the client that persists from one request to the next.</li>
  <li><em>Cache</em>: Responses from the server can be labeled as cacheable or non-cacheable so that clients (or intermediaries between clients and servers) can use a cache for optimization purposes.</li>
  <li><em>Uniform Interface</em>: The protocol by which clients access server resources must be consistent, well defined, and standardized. Hence, the commonly used uniform interface of REST web services is the HTTP protocol.</li>
  <li><em>Layered System</em>: Proxy servers, caches, or gateways can be inserted between clients and servers as necessary to improve performance, reliability, and scalability.</li>
  <li><em>Code-on-Demand</em>: Clients can optionally download code from the server to execute in their context.</li>
</ul>

<p>Before showing the reading how to actually build a web API, Grinberg mentions three additional concepts:</p>
<ul>
  <li>
    <p><strong>Resources Are Everything:</strong> <em>Resources</em> are considered the core to the REST architectural style which are nothing else then items of interest in the domain of the application (if you, e.g., consider a blogging application then <em>resources</em> would be users, blog posts, comments, etc.).<br />
Thereby each resource must have a unique URL by which it is represented (staying with the blogging example, a blog post could be represented by the URL <code class="highlighter-rouge">/api/posts/123345</code> where <code class="highlighter-rouge">12345</code> is a unique identifier for a post such as the post’s database primary key).<br /></p>
  </li>
  <li>
    <p><strong>Request Methods:</strong> While client applications send requests to a server using the corresponding URL, the request <em>method</em> indicates the desired operation. And because REST APIs use the HTTP-protocol that we are so well aware of, the respective HTTP-verbs are being exploited (i.e., the above mentioned <code class="highlighter-rouge">GET, POST, PUT, DELETE</code> to name only the most frequently used). Thereby the REST architecture does not require that all methods be implemented for a resource. An un-implemented request method would result in the client receiving a 405 status code as a response.</p>
  </li>
  <li>
    <p><strong>Request and Response Bodies:</strong>
Resources are sent back and forth between client and server in the bodies of requests and responses, but REST does not specify the format to use to encode resources. As already mentioned multiple times, the two formats commonly used with RESTful web services are JSON and XML whereby for web-based RIAS, JSON is more attractive/userful because of its usefulness in the context of Javascript.
An additional interesting aspect mentioned by Grinberg is that in a well-designed RESTful API, the client just knows a short list of top-level resource URLs and then discovers the rest from links included in the response, similar to how we can discover new web pages by simply browsing the Web by clicking on links that we stumble upon.</p>
  </li>
</ul>

<h3 id="building-a-web-api">Building a Web-API</h3>
<p>While in his book <a href="http://shop.oreilly.com/product/0636920031116.do"><em>Flask Web Development</em></a>, Grinberg guides the reader through the process of exposing the already implemented blogging platform by using the familiar <code class="highlighter-rouge">route()</code> decorator along with its <code class="highlighter-rouge">methods</code> argument to declare the routes that would handle the resource URLs exposed by the web service, in another <a href="https://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask/page/0#comments">blog post</a> Grinberg goes through a very simple ad-hoc example of how to easily create a web service that would adhere to the REST architecture by means of just a few lines of code.</p>

<p>The below example does not claim to be a complete tutorial of how to create a full-fledged RESTful API and is not backed by a proper database. It simply outlines some design aspects which in the case of a web service that adheres to the REST guidelines simply becomes an exercise in identifying the resources that will be exposed and how they will be affected by the different request methods.</p>

<p>The example that Gringberg outlines is a simple ‘To Do List’ application whereby the only resource that will be exposed by this service are <em>tasks</em>. This tasks resource will use HTTP methods as follows:</p>

<table border="1" class="dataframe">
<tbody><tr><th>HTTP Method</th><th>URI</th><th>Action</th></tr>
<tr><td>GET</td><td>http://[hostname]/todo/api/v1.0/tasks</td><td>Retrieve list of tasks</td></tr>
<tr><td>GET</td><td>http://[hostname]/todo/api/v1.0/tasks/[task_id]</td><td>Retrieve a task</td></tr>
<tr><td>POST</td><td>http://[hostname]/todo/api/v1.0/tasks</td><td>Create a new task</td></tr>
<tr><td>DELETE</td><td>http://[hostname]/todo/api/v1.0/tasks/[task_id]</td><td>Delete a task</td></tr>
</tbody>
</table>
<p><br /></p>

<p>In addition, a task as defined as having the following fields:</p>
<ul>
  <li><strong>id:</strong> unique identifier for tasks (numeric)</li>
  <li><strong>title:</strong> short description of task (string)</li>
  <li><strong>description:</strong> long task description (text)</li>
  <li><strong>done:</strong> state of task completion (boolean)</li>
</ul>

<p>Assuming that you have had a basic exposure to Python including the powerful Flask web development framework and working with virtual environments, switch to your command-line and run the following commands that create a root directory <code class="highlighter-rouge">createRESTfulAPI</code>, create a virtual environment within that root directory, activate that virtual environment, install flask using <code class="highlighter-rouge">pip</code> and create an additional folder <code class="highlighter-rouge">app</code> which will hold our application:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ mkdir createRESTfulAPI
$ cd createRESTfulAPI
$ virtualenv virtual
New python executable in ...............................
Also creating executable in ............................
Installing setuptools, pip, wheel...done.
$ source virtual/bin/activate
$ pip install flask
$ mkdir app
$ cd app</code></pre></figure>

<p>Having installed flask, a simple web application can be created by just a few lines of code that are which we will put in a file called <code class="highlighter-rouge">app.py</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">"Hello, World!"</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></figure>

<p>Let us briefly disentangle what all of the above code is actually doing (for a more comprehensive review of the basics to get started with flask, see the <a href="http://flask.pocoo.org/docs/0.12/quickstart/">quickstart manual</a>) (note that for the below it helps at least to have an intuition about Object-Oriented Programming (OOP) in Python):</p>
<ul>
  <li><code class="highlighter-rouge">from flask import Flask</code> imports the <code class="highlighter-rouge">Flask</code> class; an instance of this class will be our <a href="https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface">WSGI</a> application</li>
  <li>then we create an instance of this class with <code class="highlighter-rouge">app = Flask(__name__)</code> whereby the first argument is the name of the application’s module or package. If we are using a single module (as in this example), we should use <code class="highlighter-rouge">__name__</code> because depending on if it’s started as application or imported as module the name will be different (<code class="highlighter-rouge">__main__</code> versus the actual import name)</li>
  <li>then we use the <code class="highlighter-rouge">route()</code> decorator in <code class="highlighter-rouge">@app.route('/')</code> to tell Flask what URL should trigger our function</li>
  <li>the function is given a name which is also used to generate URLs for that particular function and then returns the message we want to display in the user’s browser</li>
  <li>with the line <code class="highlighter-rouge">if __name__ == '__main__': app.run(debug=True)</code>, we start the debugger when starting the application</li>
</ul>

<p>Now, to run this application, simply execute <code class="highlighter-rouge">python3 app.py</code> in your command-line, switch to your web-browser and type <code class="highlighter-rouge">http://localhost:5000</code> to see your application already in action (note that in my case I have to execute <code class="highlighter-rouge">python3</code> because for my system <code class="highlighter-rouge">python</code> is assigned to python 2; in your case simply running <code class="highlighter-rouge">python</code> might run already python3).<sup id="fnref:6"><a href="#fn:6" class="footnote">6</a></sup></p>

<p>As mentioned above, the proper way to install our web service would be to have it backed by a proper database. But because the tutorial is not about databases, Miguel continues the implementation of the web service by means of a simple memory structure (which will only work if the web server that runs the application in the end is single process and single threaded which is okay for Flask’s own development server but would not be recommended for a real production web server).</p>

<p>To implement the first entry point of our web service, we update the above flask - application by removing the <code class="highlighter-rouge">index</code> entry point, adding a list of dictionaries called <code class="highlighter-rouge">tasks</code> which contains the four fields which we have defined above and correspondingly create the ‘route’ (the entry-point) from which all the tasks are retrievable via a <code class="highlighter-rouge">GET</code> request:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'title'</span><span class="p">:</span> <span class="s">u'Buy groceries'</span><span class="p">,</span>
        <span class="s">'description'</span><span class="p">:</span> <span class="s">u'Milk, Cheese, Pizza, Fruit, Tylenol'</span><span class="p">,</span>
        <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'title'</span><span class="p">:</span> <span class="s">u'Learn Python'</span><span class="p">,</span>
        <span class="s">'description'</span><span class="p">:</span> <span class="s">u'Need to find a good Python tutorial on the web'</span><span class="p">,</span>
        <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_tasks</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'tasks'</span><span class="p">:</span> <span class="n">tasks</span><span class="p">})</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></figure>

<p>The implemented <code class="highlighter-rouge">get_tasks</code> function is associated with the implemented URI <code class="highlighter-rouge">/todo/api/v1.0/tasks</code> and responds with our <code class="highlighter-rouge">tasks</code> data in JSON format (note the import of <code class="highlighter-rouge">jsonify</code> from flask in the header of our script and the line <code class="highlighter-rouge">return jsonify({'tasks': tasks})</code> that transforms the list of dictionaries into a JSON structure.)</p>

<p>By running the application on a local server (for this again type <code class="highlighter-rouge">python3 app.py</code> into your command-line<sup id="fnref:7"><a href="#fn:7" class="footnote">7</a></sup>) and typing <code class="highlighter-rouge">http://localhost:5000/todo/api/v1.0/tasks</code> into your browser should show you the following JSON output:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
  <span class="nl">tasks</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">description</span><span class="p">:</span> <span class="s2">"Milk, Cheese, Pizza, Fruit, Tylenol"</span><span class="p">,</span>
      <span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="s2">"id"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s2">"Buy groceries"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">description</span><span class="p">:</span> <span class="s2">"Need to find a good Python tutorial on the web"</span><span class="p">,</span>
      <span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="s2">"id"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s2">"Learn Python"</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<p>Above we have already discussed that web browsers are not the only means to issue HTTP - requests. Similarly, here we actually want to either use the <a href="https://curl.haxx.se/"><code class="highlighter-rouge">curl</code></a> - command to issue the HTTP GET - request from the command-line or use a tool like <a href="https://www.getpostman.com/">Postman</a> which is specifically designed for API development.</p>

<p>If we try to access your end-point with the <code class="highlighter-rouge">curl</code> - command via the command line, your output should like similar to the following:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 294
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 14:46:55 GMT

{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "id": 1,
      "title": "Buy groceries"
    },
    {
      "description": "Need to find a good Python tutorial on the web",
      "done": false,
      "id": 2,
      "title": "Learn Python"
    }
  ]
}</code></pre></figure>

<p>Voila - we just accessed the first end-point of our web service! Note that the part <code class="highlighter-rouge">-i</code> (which is called a ‘flag’, ‘option’, ‘argument’ or ‘parameter’ in command line jargon) stands for <code class="highlighter-rouge">--include</code> and makes the HTTP response to include the header in the output (the header can include things like server name, cookies, date of the document, etc.). For an comprehensive overview of available options for the <code class="highlighter-rouge">curl</code> tool refer to the following <a href="https://curl.haxx.se/docs/manpage.html">website</a>.</p>

<p>When ran through Postman, the response looks exactly the same:
<br />
<img src="http://localhost:4000/assets/Postman1.png" alt="" />
<br /></p>

<p>Next, we turn to extending our web service by adding an additional <code class="highlighter-rouge">GET</code> method for our tasks resource that will be used to return the data of a single task. For the corresponding <code class="highlighter-rouge">get_task()</code> - function which is associated with the URI <code class="highlighter-rouge">/todo/api/v1.0/tasks/&lt;int:task_id&gt;</code>, we add an additional check to see if the <code class="highlighter-rouge">id</code> that we are handing over the HTTP request actually exists in our database (for this we have to import the <code class="highlighter-rouge">abort</code> object of the flask library ). The corresponding code looks as follows:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">abort</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks/&lt;int:task_id&gt;'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">):</span>
    <span class="n">task</span> <span class="o">=</span> <span class="p">[</span><span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span> <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">task_id</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'task'</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span></code></pre></figure>

<p>Let us briefly disentangle the code and take a closer look in particular at the part <code class="highlighter-rouge">task = [task for task in tasks if task['id'] == task_id]</code>. The concept being applied here is a so-called <em>list comprehension</em>. List comprehensions are a very concise way to produce lists in python which can be very intuitive once you get the hang of them but can be a bit intimidating at the beginning. What proves especially useful is to rewrite a list comprehension as a for loop or a <em>lambda function</em> (which is another way to create lists in Python which we, however, will not investigate any further).</p>

<p>To briefly recap: Lists are one of the four built-in data structures in Python (besides tuples, dictionaries and sets). Like in R is a compound data type, meaning that the values stored in the list don’t need to be of the same type. They are simply an ordered collection of items or objects which can be iterated. <br />
The single best way to think about list comprehensions is to think of how we describe sets, tuples or vectors in Math:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">S</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span> <span class="o">...</span> <span class="mi">9</span><span class="p">}}</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">12</span><span class="p">})</span></code></pre></figure>

<p>In Python, list comprehensions are constructed as follows: <code class="highlighter-rouge">list_variable = [x for x in iterable]</code>. The direct translation of this into the above examples of the sets <code class="highlighter-rouge">S</code>and <code class="highlighter-rouge">V</code> would mean:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">S</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>

<span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
<span class="n">V</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">4096</span><span class="p">]</span></code></pre></figure>

<p>We see that the syntax of list comprehensions in Python is very similar to the mathematical defintions of the sets we have described above. Overall, list comprehensions are very powerful because they can be a complete substitue to for loops, lambda functions and the functions <code class="highlighter-rouge">map()</code>, <code class="highlighter-rouge">filter()</code>and <code class="highlighter-rouge">reduce()</code>.</p>

<p>Now, if we want we can even add conditionals to the list comprehensions. If, e.g., in the set <code class="highlighter-rouge">S</code> from above we would only like to get even numbers, we could write:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">S</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span></code></pre></figure>

<p>Coming back to our implementation of the new route, we see that we get the id of the task in the URL which is then handed over as the argument <code class="highlighter-rouge">task_id</code> to the route’s associated function <code class="highlighter-rouge">get_task(task_id)</code> (not to be confused with <code class="highlighter-rouge">get_tasks()</code> from our first route from above). With the argument <code class="highlighter-rouge">task_id</code> we search in our <code class="highlighter-rouge">tasks</code> array and if the id in our request does not exist in our in memory database (i.e., <code class="highlighter-rouge">len(task) == 0</code>), we return error code 404 which, according to the HTTP specification, stands for “Resource Not Found”. If, on the other hand, we find a corresponding task in our database, we again package it as JSON using <code class="highlighter-rouge">jsonify</code> and send it as a response. Start the local server again via <code class="highlighter-rouge">python3 app.py</code> and switch to the command-line to execute an HTTP request using <code class="highlighter-rouge">curl</code> as follows:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks/2
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 152
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 22:05:30 GMT

{
  "task": {
    "description": "Need to find a good Python tutorial on the web",
    "done": false,
    "id": 2,
    "title": "Learn Python"
  }
}</code></pre></figure>

<p>Requesting a non-existent tasks give us the following response:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks/3
HTTP/1.0 404 NOT FOUND
Content-Type: text/html
Content-Length: 233
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 22:07:55 GMT

&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server.  If you entered the URL manually please check your spelling and try again.&lt;/p&gt;</code></pre></figure>

<p>Querying for resource id #2 gave us the expected result. However, querying for <code class="highlighter-rouge">task_id == 3</code> returned an HTML message instead of JSON because this is how Flask generates the 404 response by default. If ran through the browser, the returned web page would look as follows:</p>

<p><br />
<img src="http://localhost:4000/assets/NotFound.png" alt="" />
<br /></p>

<p>To also respond with JSON in the event of a 404 error, we slightly tweak our 404 error handler:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">make_response</span>

<span class="nd">@app.errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">not_found</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">({</span><span class="s">'error'</span><span class="p">:</span> <span class="s">'Not found'</span><span class="p">}),</span> <span class="mi">404</span><span class="p">)</span></code></pre></figure>

<p>After this, the printed response in our command-line looks much better:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks/3
HTTP/1.0 404 NOT FOUND
Content-Type: application/json
Content-Length: 27
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 22:15:57 GMT

{
  "error": "Not found"
}</code></pre></figure>

<p>We continue with the implementation of a <code class="highlighter-rouge">POST</code> method to be able to add a new item to our task database. For this we need the <code class="highlighter-rouge">request</code> object from the flask library. Note how we switched the <code class="highlighter-rouge">methods</code> attribute from <code class="highlighter-rouge">GET</code> to <code class="highlighter-rouge">POST</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">create_task</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="ow">or</span> <span class="ow">not</span> <span class="s">'title'</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'id'</span><span class="p">:</span> <span class="n">tasks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">'id'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'title'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span>
        <span class="s">'description'</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'description'</span><span class="p">,</span> <span class="s">""</span><span class="p">),</span>
        <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span>
    <span class="p">}</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'task'</span><span class="p">:</span> <span class="n">task</span><span class="p">}),</span> <span class="mi">201</span></code></pre></figure>

<p>The following aspects are worth noting:</p>
<ul>
  <li>in Flask, data a client sends to the server is provided by the global <code class="highlighter-rouge">request</code> object</li>
  <li><code class="highlighter-rouge">request.json</code> will contain the posted data only if it came marked as JSON</li>
  <li>if the data is not there or is missing a <code class="highlighter-rouge">title</code> item, we return error code 400 (<em>bad request</em>)</li>
  <li>if the posted data is accepted as JSON, we create a new task dictionary using the id of the last task plus one via <code class="highlighter-rouge">'id': tasks[-1]['id'] + 1</code>. The construction takes the last task dictionary in our list of task dictionaries (<code class="highlighter-rouge">tasks[-1]</code>) and then extracts the <code class="highlighter-rouge">id</code> from this last task dictionary by extracting the corresponding <code class="highlighter-rouge">value</code> belonging to the key <code class="highlighter-rouge">id</code> (note that dictionaries in python are so-called <em>key-value pairs</em>.) So if our task dictionary contains e.g., two tasks, <code class="highlighter-rouge">tasks[-1]['id']</code> will evalute to <code class="highlighter-rouge">2</code>, hence <code class="highlighter-rouge">'id': tasks[-1]['id'] + 1</code> will make <code class="highlighter-rouge">'id'</code> to evalute to <code class="highlighter-rouge">3</code>.</li>
  <li>in order to hand over the data as JSON we have to set the request content type to <code class="highlighter-rouge">application/json</code> when firing the <code class="highlighter-rouge">POST</code> request via the command line</li>
  <li>we assume the <code class="highlighter-rouge">done</code> field to always start as <code class="highlighter-rouge">False</code></li>
  <li>the <code class="highlighter-rouge">description</code> field is optional and does not have to be delivered in the <code class="highlighter-rouge">POST</code> request</li>
  <li>after adding the newly created task (via <code class="highlighter-rouge">tasks.append(task)</code>)to our list of tasks (our <code class="highlighter-rouge">tasks</code> array), we respond to the client with the added task like above including a status code 201 which according to HTTP stands for “Created”</li>
</ul>

<p>Launching our web service with <code class="highlighter-rouge">python3 app.py</code> and jumping over to our command line to test the newly implemented functionality results in the following:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i -H "Content-Type: application/json" -X POST -d '{"title":"Read a book"}' http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 201 CREATED
Content-Type: application/json
Content-Length: 105
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 23:18:39 GMT

{
  "task": {
    "description": "",
    "done": false,
    "id": 3,
    "title": "Read a book"
  }
}</code></pre></figure>

<p>The above command suddenly comes along with a bunch of additional <code class="highlighter-rouge">parameters</code>. Let us review them in turn:</p>
<ul>
  <li><code class="highlighter-rouge">-i</code> was already clarified above and includes the header into an HTTP request</li>
  <li><code class="highlighter-rouge">-H</code> is used to include any number of extra headers into an HTTP request; and because ‘Content-Type’ is the name of one of the internal headers that <code class="highlighter-rouge">curl</code> would use (usually set to text/html by default), by setting it explicitly as a custom header, this externally set header will be used instead of the internal one.</li>
  <li><code class="highlighter-rouge">-X</code>specified a custom request method to use when communicating with an HTTP server; the specified request method will be sued instead of the method otherwise used (which defaults to GET)</li>
  <li><code class="highlighter-rouge">-d</code> send the specified data in a POST request to the HTTP server in the same way that a browser does when a user has filled in an HTML form and presses the submit button; this will cause <code class="highlighter-rouge">curl</code> to pass the data to the server using the content-type application/x-www-form-urlencoded.</li>
</ul>

<p>After adding this new task to our in-memory database, we can retrieve the list of all tasks including the new one:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 424
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sat, 24 Mar 2018 23:20:13 GMT

{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "id": 1,
      "title": "Buy groceries"
    },
    {
      "description": "Need to find a good Python tutorial on the web",
      "done": false,
      "id": 2,
      "title": "Learn Python"
    },
    {
      "description": "",
      "done": false,
      "id": 3,
      "title": "Read a book"
    }
  ]
}</code></pre></figure>

<p>The very last route we are going to implement is the <code class="highlighter-rouge">DELETE</code>request:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks/&lt;int:task_id&gt;'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'DELETE'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">):</span>
    <span class="n">task</span> <span class="o">=</span> <span class="p">[</span><span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span> <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s">'id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">task_id</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="n">tasks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">task</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'result'</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span></code></pre></figure>

<p>Again, like in the case for the <code class="highlighter-rouge">POST</code>request we perform the list comprehension <code class="highlighter-rouge">task = [task for task in tasks if task['id'] == task_id]</code>. If the task to be deleted indeed exists in the <code class="highlighter-rouge">tasks</code> array, the variable <code class="highlighter-rouge">task</code></p>

<p>To explain the line <code class="highlighter-rouge">tasks.remove(task[0])</code> a little bit better, let us assume that the user wants to delete the first task in our database (our in-memory array). Then we would set <code class="highlighter-rouge">&lt;int:task_id&gt;</code> equal to <code class="highlighter-rouge">1</code> in the <code class="highlighter-rouge">DELETE</code> request and the function associated with this route (i.e., <code class="highlighter-rouge">delete_task</code>) will first run the list comprehension to end up with the variable <code class="highlighter-rouge">task</code> which is itself a list and in our example would only contain one single list item, namely <code class="highlighter-rouge">[{'id': 1, 'title': 'Buy groceries', 'description': 'Milk, Cheese, Pizza, Fruit, Tylenol', 'done': False}]</code>.
<br /></p>

<p><code class="highlighter-rouge">task[0]</code> accordingly selects the first item of our list <code class="highlighter-rouge">task</code> which only consists of that one element, i.e., <code class="highlighter-rouge">task[0]</code> returns the dictionary which corresponds to the first list element in <code class="highlighter-rouge">task</code>. <code class="highlighter-rouge">tasks.remove(task[0])</code> then removes exactly the dictionary we want to remove from the <code class="highlighter-rouge">tasks</code> array which contains all currently stored tasks.</p>

<p>To test the newly created route, we run a <code class="highlighter-rouge">DELETE</code> - request via our command line to delete task #2:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i -X DELETE http://localhost:5000/todo/api/v1.0/tasks/2
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 21
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sun, 25 Mar 2018 11:34:32 GMT

{
  "result": true
}</code></pre></figure>

<p>Our new <code class="highlighter-rouge">tasks</code> array then looks as follows:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 163
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sun, 25 Mar 2018 11:36:28 GMT

{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "id": 1,
      "title": "Buy groceries"
    }
  ]
}</code></pre></figure>

<h4 id="small-improvements">Small Improvements</h4>
<p>Our home-made web service is actually fully functional by now but there are two additional improvements we want to add which also Miguel Grinberg has included in his original <a href="https://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask/page/0#comments">blog post</a>.</p>

<p>First, the problem with the current design of the web API is that we assume clients to know how the respective URIs are built (in practice this is also usually the case since all major web APIs come along with ample documentation).
But there is another drawback: If we would want to apply any changes to these URIs in the future, we first would have to update relevant documentation, educate users, etc. Therefore it is easier if we return the full URIs that control a task (instead of only the task ids) so that clients always get the URIs ready to be used along with their requests. For this, we add a small helper function that generates a “public” version of a task that will be sent to the client along with a request:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">url_for</span>

<span class="k">def</span> <span class="nf">make_public_task</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>
    <span class="n">new_task</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s">'id'</span><span class="p">:</span>
            <span class="n">new_task</span><span class="p">[</span><span class="s">'uri'</span><span class="p">]</span> <span class="o">=</span> <span class="n">url_for</span><span class="p">(</span><span class="s">'get_task'</span><span class="p">,</span> <span class="n">task_id</span><span class="o">=</span><span class="n">task</span><span class="p">[</span><span class="s">'id'</span><span class="p">],</span> <span class="n">_external</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_task</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">new_task</span></code></pre></figure>

<p>Let us explain what the above function <code class="highlighter-rouge">make_public_task</code> is doing:
If we quickly start a python session in our shell (by executing <code class="highlighter-rouge">python3</code> in our command line window and then create our tasks array, we can just pick one task out of the <code class="highlighter-rouge">tasks</code> array (our list of dictionaries) with which we have been working so far and assign it to the variable <code class="highlighter-rouge">task1</code> as shown below:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="err">$</span> <span class="n">python3</span>
<span class="n">Python</span> <span class="mf">3.6</span><span class="o">.</span><span class="mi">4</span> <span class="p">(</span><span class="n">v3</span><span class="o">.</span><span class="mf">6.4</span><span class="p">:</span><span class="n">d48ecebad5</span><span class="p">,</span> <span class="n">Dec</span> <span class="mi">18</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">21</span><span class="p">:</span><span class="mo">07</span><span class="p">:</span><span class="mi">28</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">4.2</span><span class="o">.</span><span class="mi">1</span> <span class="p">(</span><span class="n">Apple</span> <span class="n">Inc</span><span class="o">.</span> <span class="n">build</span> <span class="mi">5666</span><span class="p">)</span> <span class="p">(</span><span class="n">dot</span> <span class="mi">3</span><span class="p">)]</span> <span class="n">on</span> <span class="n">darwin</span>

<span class="n">Type</span> <span class="s">"help"</span><span class="p">,</span> <span class="s">"copyright"</span><span class="p">,</span> <span class="s">"credits"</span> <span class="ow">or</span> <span class="s">"license"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
<span class="o">...</span>     <span class="p">{</span>
<span class="o">...</span>         <span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'title'</span><span class="p">:</span> <span class="s">u'Buy groceries'</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'description'</span><span class="p">:</span> <span class="s">u'Milk, Cheese, Pizza, Fruit, Tylenol'</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span>
<span class="o">...</span>     <span class="p">},</span>
<span class="o">...</span>     <span class="p">{</span>
<span class="o">...</span>         <span class="s">'id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'title'</span><span class="p">:</span> <span class="s">u'Learn Python'</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'description'</span><span class="p">:</span> <span class="s">u'Need to find a good Python tutorial on the web'</span><span class="p">,</span>
<span class="o">...</span>         <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span>
<span class="o">...</span>     <span class="p">}</span>
<span class="o">...</span> <span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'title'</span><span class="p">:</span> <span class="s">'Buy groceries'</span><span class="p">,</span> <span class="s">'description'</span><span class="p">:</span> <span class="s">'Milk, Cheese, Pizza, Fruit, Tylenol'</span><span class="p">,</span> <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">task1</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></pre></figure>

<p>Next, we create an empty dictionary called <code class="highlighter-rouge">new_task</code> and then iterate through all keys of the <code class="highlighter-rouge">task1</code> dictionary (which represents one single task). If the current key is not <code class="highlighter-rouge">id</code>, we simply add the current key-value pair to our newly created dictionary <code class="highlighter-rouge">new_task</code>. However, if the current key we are  looking at is the <code class="highlighter-rouge">id</code>, we create an entry in our dictionary with the key <code class="highlighter-rouge">uri</code> instead and the corresponding value equal to the respective tasks URI. <br />
If we were to perform the above description manually for one task, we would have the following:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">new_task</span> <span class="o">=</span> <span class="p">{}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_task</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">task1</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_task</span><span class="p">[</span><span class="s">'done'</span><span class="p">]</span> <span class="o">=</span> <span class="n">task1</span><span class="p">[</span><span class="s">'done'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_task</span><span class="p">[</span><span class="s">'description'</span><span class="p">]</span> <span class="o">=</span> <span class="n">task1</span><span class="p">[</span><span class="s">'description'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_task</span>
<span class="p">{</span><span class="s">'title'</span><span class="p">:</span> <span class="s">'Buy groceries'</span><span class="p">,</span> <span class="s">'done'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">'description'</span><span class="p">:</span> <span class="s">'Milk, Cheese, Pizza, Fruit, Tylenol'</span><span class="p">}</span></code></pre></figure>

<p>For the key <code class="highlighter-rouge">id</code> as described above, instead we want to generate the URI which we do by using Flasks <code class="highlighter-rouge">url_for</code> - function. How does that work?<br />
Remembering that the <code class="highlighter-rouge">route()</code> decorator in flask is used to bind a function to a URL, the <code class="highlighter-rouge">url_for()</code> command generates the URI which is associated with a particular function. In our case, the URI we want to create is the URI associated with the function <code class="highlighter-rouge">get_task(task_id)</code> which we have defined above. But because we cannot generate a URL without the application actually running, I will only write down the code that will generate exactly what we want (namely the associated value belonging to the key <code class="highlighter-rouge">uri</code>): <br /><code class="highlighter-rouge">new_task['uri'] = url_for('get_task', task_id=task['id'], _external=True)</code></p>

<p>Having disentangled the newly created function, we can then pass the list of tasks through this newly created function before sending them to the client by slightly changing the very first route which we have implemented (again pay attention to the list comprehension used):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_tasks</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'tasks'</span><span class="p">:</span> <span class="p">[</span><span class="n">make_public_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">]})</span></code></pre></figure>

<p>So now if we want to get a list of all tasks we would get the following:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 407
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sun, 25 Mar 2018 14:41:25 GMT

{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "title": "Buy groceries",
      "uri": "http://localhost:5000/todo/api/v1.0/tasks/1"
    },
    {
      "description": "Need to find a good Python tutorial on the web",
      "done": false,
      "title": "Learn Python",
      "uri": "http://localhost:5000/todo/api/v1.0/tasks/2"
    }
  ]
}</code></pre></figure>

<p>We should apply this technique to all other functions to ensure that the client always also sees the URIs instead of the ids (not shown here).</p>

<p>The very last piece we want to implement following <a href="https://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask/page/0#comments">Grinberg’s post</a> is to secure our web service with an authentication. by requiring clients to provide a username and password.<br />
Usually in web applications where we would have a login form that sends the credentials to the server which then creates a session for the logged in user would violate the <em>stateless</em> requirement of REST. Therefore, instead we have to ask clients to send their authentication information with every request they send to us.
and because with REST we always try to adhere to the HTTP protocol as much as we can, we can make use of the Flask extension <code class="highlighter-rouge">Flask-HTTPAuth</code> which allows us to secure our web API. For this, we first have to install the extension with</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ pip install flask-httpauth</code></pre></figure>

<p>and then import the <code class="highlighter-rouge">HTTPBasicAuth</code> object into our script <code class="highlighter-rouge">app.py</code>, instantiate an instance of the <code class="highlighter-rouge">HTTPBasicAuth</code> object and then implement the two callback functions <code class="highlighter-rouge">get_password</code> and <code class="highlighter-rouge">error_handler</code> (obviously you have to replace <code class="highlighter-rouge">your_password</code> and <code class="highlighter-rouge">your_username</code> with your own credentials of choice):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_httpauth</span> <span class="kn">import</span> <span class="n">HTTPBasicAuth</span>
<span class="n">auth</span> <span class="o">=</span> <span class="n">HTTPBasicAuth</span><span class="p">()</span>

<span class="nd">@auth.get_password</span>
<span class="k">def</span> <span class="nf">get_password</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s">'your_username'</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'your_password'</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="nd">@auth.error_handler</span>
<span class="k">def</span> <span class="nf">unauthorized</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="n">jsonify</span><span class="p">({</span><span class="s">'error'</span><span class="p">:</span> <span class="s">'Unauthorized access'</span><span class="p">}),</span> <span class="mi">401</span><span class="p">)</span></code></pre></figure>

<p>The callback function <code class="highlighter-rouge">get_password</code> is used by the extension to obtain the password for a given user (in the case of an application backed by a database, we would check the user’s table).<br />
The function <code class="highlighter-rouge">error_handler</code> will be used by the extension in case an unauthorized client tries to access the service. Like we did with other custom error messages, we make sure that it contains JSON instead of HTML.</p>

<p>Having implemented the above, the only thing left is to indicate all the functions that need to be protected by adding the <code class="highlighter-rouge">@auth.login_required</code> at the respective positions in the code.For our <code class="highlighter-rouge">GET</code> request that returns all tasks at once, this would look as follows:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nd">@app.route</span><span class="p">(</span><span class="s">'/todo/api/v1.0/tasks'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="nd">@auth.login_required</span>
<span class="k">def</span> <span class="nf">get_tasks</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">'tasks'</span><span class="p">:</span> <span class="p">[</span><span class="n">make_public_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">]})</span></code></pre></figure>

<p>If we would now request all tasks without authentication we would get the following output printed to our command line:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 401 UNAUTHORIZED
Content-Type: application/json
WWW-Authenticate: Basic realm="Authentication Required"
Content-Length: 37
Server: Werkzeug/0.14.1 Python/3.6.4
Date: Sun, 25 Mar 2018 15:41:33 GMT

{
  "error": "Unauthorized access"
}</code></pre></figure>

<p>If we, however, hand our credentials over to the request, we get the full response as expected:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">$ curl -u your_username:your_password http://localhost:5000/todo/api/v1.0/tasks
{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "title": "Buy groceries",
      "uri": "http://localhost:5000/todo/api/v1.0/tasks/1"
    },
    {
      "description": "Need to find a good Python tutorial on the web",
      "done": false,
      "title": "Learn Python",
      "uri": "http://localhost:5000/todo/api/v1.0/tasks/2"
    }
  ]
}</code></pre></figure>

<p>Note that we changed the flag <code class="highlighter-rouge">-i</code> to <code class="highlighter-rouge">-u</code> which is the necessary flag to be able to specify user name and password to use for server authentication right after the flag. If we would only specify the user name, <code class="highlighter-rouge">curl</code> would prompt for a password.</p>

<p>Having successfully replicated Miguel’s amazing <a href="https://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask/page/0#comments">post</a>], there is time to briefly about possible improvements that Miguel himself suggested:</p>
<ul>
  <li>A real web service should be backed by a real databases. So at some point we should get rid of the in memory structure and apply a MySQL or PostgreSQL database.</li>
  <li>Our web service could be extended to be able to handle multiple users and correspondingly maintain multiple lists. In such a system we would have a second resource which would be the users.</li>
  <li>The implemented <code class="highlighter-rouge">GET</code> request for the entire task list could be extended with a filter functionality.</li>
</ul>

<h4 id="deployment-to-a-real-web-server">Deployment to a real web server</h4>
<p>Being able to run our little web service on a local server, we want to add one more piece to the story by deploying it to a real web server via ‘Heroku’ so that we can ask a friend to access our web service as well.<br /></p>

<p>In order to do this we assume (1) that you are vaguely familiar with <a href="https://git-scm.com/">‘git’</a> and (2) the deployment process using ‘heroku’. This means that you have to have (1) <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">‘git’ installed on your machine</a> and (2) that you have to have at least a free account on <a href="https://www.heroku.com/home">heroku.com</a> as well as the <a href="https://devcenter.heroku.com/articles/heroku-cli">Heroku Command Line Interface (CLI)</a> installed.<br />
Below we will go through the deployment process in 10 easy steps, assuming that your folder-structure looks like the below and you are currently in your <code class="highlighter-rouge">/app</code> directory and your virtual environment is still activated:</p>

<figure class="highlight"><pre><code class="language-raw" data-lang="raw">CreateRESTfulAPI/
  app/
    app.py
  virtual/</code></pre></figure>

<p>In case you are in the <code class="highlighter-rouge">/app</code> directory but your virtual environment is deactivated execute <code class="highlighter-rouge">$ source ../virtual/bin/activate</code> and your virtual environment should be activated again.</p>
<ol>
  <li>
    <p>Execute <code class="highlighter-rouge">pip install gunicorn</code>. <code class="highlighter-rouge">gunicorn</code> is a Python WSGI HTTP Server and needed later by Heroku to be able to run our application.</p>
  </li>
  <li>
    <p>Execute <code class="highlighter-rouge">pip freeze &gt; requirements.txt</code> to create the file <code class="highlighter-rouge">requirements.txt</code> - file that contains a list of all the python packages that are currently in your virtual installation. This file is necessary to tell ‘Heroku’ what to install in their system.</p>
  </li>
  <li>
    <p>Create a file called <code class="highlighter-rouge">Procile</code> without an extension and write <code class="highlighter-rouge">web: gunicorn app:app</code> whereby the first instance of <code class="highlighter-rouge">app</code> refers to the name of your file <code class="highlighter-rouge">app.py</code> and the second <code class="highlighter-rouge">app</code> refers to the name of the variable holding the Flask instance.</p>
  </li>
  <li>
    <p>The last file we need is a file called <code class="highlighter-rouge">runtime.txt</code> in which we have to write the version of python we want our app to run on. To specify the correct version, simply refer to the <a href="https://devcenter.heroku.com/articles/python-runtimes">Heroku DevCenter</a> that always lists the latest supported python distributions for Python 2 and 3. In our case, we write <code class="highlighter-rouge">python-3.6.4</code> to our file.</p>
  </li>
  <li>Next, we have to log in to <code class="highlighter-rouge">heroku</code> from the command line ty executing <code class="highlighter-rouge">heroku login</code>. When asked type in your Email-address and password.
    <pre><code class="language-raw">$ heroku login
Enter your Heroku credentials:
Email: &lt;your_email_address&gt;
Password: &lt;your_password&gt;
Logged in as &lt;your_email_address&gt;
</code></pre>
  </li>
  <li>
    <p>We create a new app by executing <code class="highlighter-rouge">heroku create todo-api-tutorial</code>. Note that you will have to use a different name because <code class="highlighter-rouge">todo-api-tutorial</code> will already be taken by me unless I deleted this app again in the meantime and the name is free again.</p>
  </li>
  <li>Type the following sequence of commands that creates a local git repository, stages all files in the repository and commits all changes:
    <pre><code class="language-raw">$ git init
Initialized empty Git repository in ..........................
$ git add .
$ git commit -m "first commit"
[master (root-commit) 77ab482] first commit
 5 files changed, 287 insertions(+)
 create mode 100644 Procfile
 create mode 100644 app.py
 create mode 100644 requirements.txt
 create mode 100644 runtime.txt
 create mode 100644 tasks.txt
</code></pre>
  </li>
  <li>
    <p>We want to connect to our <code class="highlighter-rouge">todo-api-tutorial</code> app by executing <code class="highlighter-rouge">heroku git:remote --app todo-api-tutorial</code>. To check that the connection was successful run <code class="highlighter-rouge">heroku info</code>.</p>
  </li>
  <li>By running <code class="highlighter-rouge">git push heroku master</code> will detect all the files that you created above, install all dependencies and packages specified in <code class="highlighter-rouge">requirements.txt</code> and ultimately deploy the app. The entire deployment process should end with
    <pre><code class="language-raw">remote: Verifying deploy... done.
To https://git.heroku.com/todo-api-tutorial.git
 * [new branch]      master -&gt; master
</code></pre>
  </li>
  <li>Now comes the big moment where we will check whether our deployed web service is now actually also retrievable. Executing the below <code class="highlighter-rouge">GET</code> request in your command line should give you the following output:
    <pre><code class="language-raw">$ curl -u your_username:your_password http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks
{
  "tasks": [
{
  "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
  "done": false,
  "title": "Buy groceries",
  "uri": "http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks/1"
},
{
  "description": "Need to find a good Python tutorial on the web",
  "done": false,
  "title": "Learn Python",
  "uri": "http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks/2"
}
  ]
}
</code></pre>
    <p>If so, congratulations!</p>
  </li>
</ol>

<p>In a similar fashion, you can add a task:</p>
<pre><code class="language-raw">$ curl -u your_username:your_password -H "Content-Type: application/json" -X POST -d '{"title":"Read a book"}' http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks
{
  "task": {
    "description": "",
    "done": false,
    "id": 4,
    "title": "Read a book"
  }
}
</code></pre>

<p>and then again retrieve the newly updated list:</p>
<pre><code class="language-raw">$ curl -u your_username:your_password http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks
{
  "tasks": [
    {
      "description": "Milk, Cheese, Pizza, Fruit, Tylenol",
      "done": false,
      "title": "Buy groceries",
      "uri": "http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks/1"
    },
    {
      "description": "Need to find a good Python tutorial on the web",
      "done": false,
      "title": "Learn Python",
      "uri": "http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks/2"
    },
    {
      "description": "",
      "done": false,
      "title": "Read a book",
      "uri": "http://todo-api-tutorial.herokuapp.com/todo/api/v1.0/tasks/3"
    }
  ]
}
</code></pre>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Building on all of the above, a fairly neat explanation is given by <a href="https://study.com/academy/lesson/application-programming-interface-api-definition-example.html">Martin Gibbs</a> where he states that <em>APIs are a set of tools that programmers can use in helping them create software</em> and thereby <em>allow a programmer to deliver solid solutions fairly rapidly without having to rebuild everything from scratch every time.</em> <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>Note that depending on whether or not you already have it, there is a Chrome-extension called <a href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc?hl=de">JSONView</a> that nicely formats raw JSON-responses in the browser. Similar tools should also be available for other browsers. <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>We could, for example, easily type <code class="highlighter-rouge">curl http://www.google.com</code> into our command-line and get back a whole mess of unstructured HTML that a browser would usually nicely render for us when we request http://www.google.com from the browser. In other words, web APIs are designed to return structured data (in XML or JSON) and <em>not</em> to respond with HTML. <a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:4">
      <p>Note that although Ryan Mitchell declares that using APIs is generally not considered classical <em>web scraping</em>, he declares that both practices (of <em>web scraping</em> and using dedicated <em>web APIs</em>) make use of the same techniques and can often be very complementary to each other (p. 49). <a href="#fnref:4" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:5">
      <p>From the way Grinberg introduces APIs I would conclude that he already jumps into <em>web APIs</em> without dealing with other things that could represent an API. <a href="#fnref:5" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:6">
      <p>Although there are Flask extensions that would help with building a RESTful service using Flask, Miguel decides to continue his tutorial without extensions. <a href="#fnref:6" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:7">
      <p>Note that your terminal must be in the respective directory where your file <code class="highlighter-rouge">app.py</code> is located in order for the command <code class="highlighter-rouge">python3 app.py</code> to start Flask’s local server. <a href="#fnref:7" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <p>A bit of economics, data and programming.</p>
      </div>

      <div class="footer-col footer-col-2">

      </div>

      <div align="right" class="footer-col footer-col-3">
        <ul class="social-media-list">

          
          <li>
            <a href="https://github.com/himynameismarcel"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">himynameismarcel</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/marcel_kay_mav"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">marcel_kay_mav</span></a>

          </li>
          
        </ul>
      </div>

    </div>


</footer>


  </body>

</html>
